"use strict";!function(e){var t="object"==typeof self&&self.self==self&&self||"object"==typeof global&&global.global==global&&global;"object"==typeof exports&&"object"==typeof module?module.exports=e():"object"==typeof exports?exports.AjaxForm=e():(t.ICEPlugs||(t.ICEPlugs={}),t.ICEPlugs.AjaxForm=e())}(function(){var e=999,t=window.ICEPlugs||{},i=t.url;i||(i=require("url"));var n=function(t){t=t||{},this.$el="string"==typeof t.el?$(t.el):t.el,this.uid="AjaxForm"+e++,this._iframeLoadState=!1,this._success=t.success,this._before=t.before,this._failure=t.failure,this._init()};n.prototype._init=function(){this._createIframe(),this._addEvent()},n.prototype._createIframe=function(){var e='<iframe id="'+this.uid+'" name="'+this.uid+'"  style="display: none;" src="about:blank"></iframe>';this.$el.attr("target",this.uid),this.$el.append(e),this._iframe=$("#"+this.uid),$("<input />").attr({type:"hidden",name:"cross_post",value:"1"}).appendTo(this.$el)},n.prototype._addEvent=function(){var e=this;this._iframe.on("load",function(){if(e._iframeLoadState){var t=this.contentWindow,i=t.location;if("about:blank"===i.href)"function"==typeof e._failure&&e._failure.call(this);else if("function"==typeof e._success)try{var n=this._iframe[0].contentWindow.document.body;innerText=n.innerText,innerText||(innerText=n.innerHTML),innerText&&e._success.call(this,$.parseJSON(innerText))}catch(a){e._success.call(this)}e._iframeLoadState=!1}})},n.prototype.setIframeState=function(e){this._iframeLoadState=e},n.prototype.encrypto=function(e){var t=this;$.each(e,function(e,i){var n=t.$el.find("[name="+e+"]");0===n.length?$("<input />").attr({type:"hidden",name:e,value:i}).appendTo(t.$el):n.val(i)})};var a=null;return n.sharedInstanceAjaxForm=function(e,t){return a||(t=t||{},t.el=e,a=new n(t)),a},n.classInstanceAjaxForm=function(e,t){return t=t||{},t.el=e,new n(t)},n});