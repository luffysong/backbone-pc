/**
 * @project yinyuetai_pc_live_video
 * @description 音悦台直播PC版
 * @version v1.0.0
 * @time 2016-4-29   10:38:56
 * @author YYT
 * @copy http://www.yinyuetai.com
 */
webpackJsonp([1],[function(e,t,i){$(function(){var e=i(76);new e,i(114)})},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,i){var n={},s={title:"消息",content:"",okFn:null,cancelFn:null,okBtn:!0,cancelBtn:!0};n.init=function(e){var t=_.template(this.getHTML()),i=t(e);this.remove(),this.bindEvent(i,e.okFn,e.cancelFn)},n.remove=function(){var e=$("#UIConfigWrap");e&&e.length>=1&&e.remove()},n.getHTML=function(){return i(42)},n.bindEvent=function(e,t,i){var n=this;e=$(e),e.find("#UIConfirmOk").on("click",function(e){return e.preventDefault(),t&&t(),n.remove(),!1}),e.find(".UIConfirmClose").on("click",function(e){return e.preventDefault(),i&&i(),n.remove(),!1}),e.find("#UIConfirmOk").on("click",function(e){return e.preventDefault(),n.remove(),!1}),$("body").append(e)},n.show=function(e){var t=_.extend(s,e);this.init(t)},n.close=function(){this.remove()},e.exports={show:function(e){n.show(e)},close:function(){n.close()}}},function(e,t){e.exports='<div id="UIConfigWrap" class="shadow_screen">\n    <div class="shadow"></div>\n    <div class="edit_annmoucement_con" style="margin-bottom: 16px; width: 400px;margin-left:-200px;">\n        <h2 class="edit_title"><span id="UIConfirmTitle"><%=title%></span> <span class="close UIConfirmClose">X</span></h2>\n        <div class="editCon" style="">\n            <div class="content" style="padding:16px; font-size: 14px;"><%=content%></div>\n            <p class="btn-wrap" style="">\n                <a style="display: <%= cancelBtn?\'inline-block\':\'none\'%>;" href="javascript:;" class="cancel UIConfirmClose">取消</a>\n                <a style="display: <%= okBtn?\'inline-block\':\'none\'%>;" id="UIConfirmOk" href="javascript:;" class="submit active">确定</a>\n            </p>\n        </div>\n    </div>\n</div>'},,function(e,t,i){"use strict";var n=i(27),s=(n.sharedInstanceUserModel(),i(23)),a=s.sharedInstanceIMModel();e.exports={onlyAnchorUse:function(e){a.fetchIMUserSig(function(t){t.anchor||(window.location.href=e||"/index.html")},function(){window.location.href="/index.html"})}}},,,function(e,t,i){"use strict";var n=i(48),s=i(28),a=i(49),o=function(e){var t=this;this.options=e,this.dialog=s.classInstanceDialog(n,e),this.helper=new a({ctrlData:this.options.ctrlData,id:"#"+this.dialog.id}),this.helper.on("uploadFileSuccess",function(e){"function"==typeof t.options.uploadFileSuccess&&t.options.uploadFileSuccess(e)}),this.helper.on("saveFile",function(){"function"==typeof t.options.saveFile&&t.options.saveFile()})};o.prototype.show=function(e){this.helper&&e&&this.helper.trigger("successBreviary",e),this.dialog.show()},o.prototype.hide=function(){this.dialog.hide()},o.prototype.emptyValue=function(){this.helper&&this.helper.emptyValue()},o.prototype.parseErrorMsg=function(e){if(e&&"SUCCESS"==e.state)return!0;var t=1*e.errCode||0;switch(t){case 29:return"上传的文件太大了,请重新上传";case 31:return"请上传JPGE,JPG,PNG,GIF等格式的图片文件"}return"文件上传失败,请重新上传"};var r=null;o.sharedInstanceUploadFileDialog=function(e){return r||(r=new o(e)),r},e.exports=o},function(e,t){e.exports='<div class="shadow"></div>\n<div class="edit_Bg_form_x" id="uploadFileDialog">\n	<h2 class="edit_title">\n		<span class="upload-title">背景图设置</span>\n		<span class="upload-status upload-image-state"></span>\n	</h2>\n	<div class="formCon clearfix">\n		<div class="imgBox fl">\n			<img src="" alt="" width="100%" height="100%"  style="display: none;" class="imgboxFile">\n		</div>\n		<div class="formBox fl">\n			<div class="pseudo-uploadBtn">\n				<span class="input-text">上传图片</span>\n				<form class="upload-form">\n\n				</form>\n			</div>\n			<p>支持5M以内的gif、jpg、jpge、png图片上传</p>\n			<div class="submit">保存</div>\n		</div>\n	</div>\n</div>\n'},function(e,t,i){"use strict";var n=i(16),s=i(50),a="正在上传",o="上传完成!",r=i(51),l=window.location,c=n.extend({rawLoader:function(){},events:{"click .submit":"saveHandler","change .upload-file":"changeFile"},beforeMount:function(){},afterMount:function(){this.formDOM=this.$el.find(".upload-form"),this.imgSrcDOM=this.$el.find(".imgboxFile"),this.imageStateDOM=this.$el.find(".upload-image-state"),this.inputTextDOM=this.$el.find(".input-text")},ready:function(e){var t=e.ctrlData||{cmd:[{saveOriginal:1,op:"save",plan:"avatar",belongId:"20634338",srcImg:"img"}],redirect:l.origin+"/web/upload.html"},i=this;this.upload=s.classInstanceUploadFile({el:this.formDOM,url:"http://image.yinyuetai.com/edit",data:t,filename:"img",className:"file",success:function(e){i.imageStateDOM.html(o),i.previewImage(e),i.trigger("uploadFileSuccess",e)},failure:function(){r.showError("上传失败")}}),this.on("successBreviary",function(e){this.successBreviary(e)})},successBreviary:function(e){this.emptyValue(),e.breviaryUrl&&(this.imgSrcDOM.attr("src",e.breviaryUrl),this.imgSrcDOM.show()),e.inputText&&this.inputTextDOM.text(e.inputText)},saveHandler:function(e){this.trigger("saveFile")},changeFile:function(e){this.imageStateDOM.html(a),this.upload.submit()},previewImage:function(e){var t=e.images;if(t&&t.length>0){var i=t[0].path;this.imgSrcDOM.attr("src",i),this.imgSrcDOM.show()}},emptyValue:function(){this.imageStateDOM.html(""),this.imgSrcDOM.hide(),this.inputTextDOM.text("上传图片")}}),d=null;c.sharedInstanceUploadFileDialog=function(e){return d||(d=new c(e)),d},c.fetchDialogTemplate=function(){return i(48)},e.exports=c},function(e,t,i){(function(t){"use strict";!function(i){"object"==typeof self&&self.self==self&&self||"object"==typeof t&&t.global==t&&t;e.exports=i()}(function(){var e=999,t=window,n=t.ICEPlugs||{},s=n.url;s||(s=i(26));var a=n.tools;a||(a=i(21));var o=n.AjaxForm;o||(o=i(33));var r=null,l=function(t){var i=this;return this.$el="string"==typeof t.el?$(t.el):t.el,this.uid="UploadFile"+e++,this.options=t,this._data=t.data||{},this._filename=t.filename||"image",this._success=t.success,this._before=t.before,this._failure=t.failure,this._url=t.url,this._url?(this._init(),void(this.ajaxForm=o.classInstanceAjaxForm(this.$el,{type:"img",success:function(){var e=this.contentWindow,t=(e.location,decodeURIComponent(e.location.search)),n=s.parseSearch(t);"function"==typeof i._success&&i._success.call(this,n)},failure:function(){"function"==typeof i._failure&&i._failure.call(this)}}))):void console.warn("配置上传URL")};return l.prototype._init=function(){this._createElement()},l.prototype._createElement=function(){var e="";for(var t in this._data){var i=this._data[t],n=a.toType(i);"[object Object]"!==n&&"[object Array]"!==n||(i=JSON.stringify(i)),e+='<input type="hidden" name="'+t+"\" value='"+i+"'/>"}e+='<input type="file" class="opacity0 upload-file '+this.options.className+'" name="'+this._filename+'"  />',this.$el.attr("method","POST"),this.$el.attr("action",this._url),this.$el.attr("enctype","multipart/form-data"),this.$el.append(e)},l.prototype.submit=function(){this.ajaxForm.setIframeState(!0),"function"==typeof this._before&&this._before(),this.$el.submit()},l.sharedInstanceUploadFile=function(e){return r||(r=new l(e)),r},l.classInstanceUploadFile=function(e){return new l(e)},l.prototype.parseErrorMsg=function(e){if(e&&"SUCCESS"==e.state)return!0;var t=1*e.errCode||0;switch(t){case 29:return"上传的文件太大了,请重新上传";case 31:return"请上传JPGE,JPG,PNG,GIF等格式的图片文件"}return"文件上传失败,请重新上传"},l})}).call(t,function(){return this}())},,,,,,,function(e,t,i){(function(t){"use strict";!function(i){"object"==typeof self&&self.self==self&&self||"object"==typeof t&&t.global==t&&t;e.exports=i()}(function(){var e=function(e){this.temp=new Date,this.setCurNewDate(e)};e.prototype.changeYear=function(e){this.temp.setFullYear(e)},e.prototype.getCountDays=function(e){return this.temp.setMonth(e),this.temp.setDate(0),this.temp.getDate()},e.prototype.$get=function(e){return this.attrs[e]},e.prototype.ceilYear=function(e){e=~~e;for(var t=0,i=this.$get("year"),n=[];e>=t;t++)n.push(i),i+=1;return n},e.prototype._downDisplacement=function(e){var t,i=this.$get(e),n=[];switch(e){case"month":t=12;break;case"day":t=this.getCountDays(this.$get("month"));break;case"hours":t=23;break;default:t=59}for(;t>=i;i++)n.push(i);return n},e.prototype.downMonth=function(){return this._downDisplacement("month")},e.prototype.downDay=function(){return this._downDisplacement("day")},e.prototype.downHours=function(){return this._downDisplacement("hours")},e.prototype.downMinutes=function(){return this._downDisplacement("minutes")},e.prototype.down=function(e){return this._downDisplacement(e)},e.prototype.getTime=function(e){var t="",i=e.month<10?"0"+e.month:e.month,n=e.day<10?"0"+e.day:e.day,s=e.hours<10?"0"+e.hours:e.hours,a=e.minutes<10?"0"+e.minutes:e.minutes;return t+=e.year+"-"+i+"-"+n+" ",t+=s+":"+a+":00",new Date(t.replace(/-/g,"/")).getTime()},e.prototype.setCurNewDate=function(e){this.date=null,this.date=e?new Date(e):new Date,this._setAttrs()},e.prototype._setAttrs=function(){this.attrs=null,this.attrs={year:this.date.getFullYear(),month:this.date.getMonth()+1,day:this.date.getDate(),hours:this.date.getHours(),minutes:this.date.getMinutes()}},e.difference=function(e){var t={};t.day=parseInt(e/864e5);var i=e%864e5,n=Math.floor(i/36e5);t.hours=10>n?"0"+n:n;var s=i%36e5,a=Math.floor(s/6e4);t.minutes=10>a?"0"+a:a;var o=s%6e4,r=Math.floor(o/1e3);return t.seconds=10>r?"0"+r:r,t};var t=null;return e.sharedInstanceDateTime=function(){return t||(t=new e),t},e}),Date.prototype.Format=function(e){var t={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(var i in t)new RegExp("("+i+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?t[i]:("00"+t[i]).substr((""+t[i]).length)));return e}}).call(t,function(){return this}())},,,,,,,,,,,,,,,,,,,function(e,t,i){"use strict";var n=i(16),s=i(27),a=i(69),o=i(23),r=i(77),l=i(25),c=i(78),d=i(82),h=i(85),u=i(88),p=(i(28),i(47)),f=o.sharedInstanceIMModel(),m=s.sharedInstanceUserModel(),v=i(51),g=(i(44),n.extend({el:"#settingContent",events:{"click #editBgBtn":"editBgHandler"},rawLoader:function(){return i(113)},beforeMount:function(){this.topbarView=new a,this.isLogined=!1,this.upload=null,this.bgTheme=null,this.anchorSig=null,this.updateBgParameter={deviceinfo:'{"aid":"30001001"}'},this.tempImg=null,this.saveLock=!0,this.uploadSate=!1,this.updateBgModel=new r},afterMount:function(){this.profileBg=$("#profileBg")},ready:function(){var e=this;m.isLogined()?this.fetchIMUserSig():(l.remove("imSig"),l.set("signout",1),window.location.href="/web/login.html",this.topbarView.on("logined",function(){e.fetchIMUserSig()}))},initRender:function(){var e=this,t={width:580,height:341,isRemoveAfterHide:!1,isAutoShow:!1,mainClass:"shadow_screen_x",closeClass:"editor_bg_close_x",closeText:"X",title:"背景设置",ctrlData:{cmd:[{saveOriginal:1,op:"save",plan:"avatar",belongId:"20634338",srcImg:"img"}],redirect:"http://"+window.location.host+"/cross-url/upload.html"},uploadFileSuccess:function(t){var i=e.upload.parseErrorMsg(t);1==i?(e.uploadSate=!0,e.uploadSuccess(t)):v.showTip(i)},saveFile:function(){e.uploadSate?e.saveFile():v.showError("正在上传，请等待")}};this.upload=new p(t),this.isLogined=!0,this.profileView=new c,this.pageContentView=new u,f.isAnchor()&&(this.editProfileView=new d),this.updatePasswordView=new h},fetchIMUserSig:function(){var e=this;this.updateBgParameter.access_token="web-"+m.getToken(),f.fetchIMUserSig(function(t){t.anchor?(e.anchorSig=t,e.bgTheme=t.anchor.bgTheme,e.setPageBgimg(t.anchor.bgTheme),e.initRender()):e.initRender()},function(e){v.showError("获取签名错误")})},editBgHandler:function(e){if(this.isLogined){var t=null;this.anchorBg&&(t={inputText:"编辑背景",breviaryUrl:this.anchorBg}),this.upload.emptyValue(),this.upload.show(t)}else v.showError("未登录或获取签名失败")},uploadSuccess:function(e){var t=e.images,i=t[0].path;this.tempImg=i},saveFile:function(){var e=this;this.saveLock&&(this.saveLock=!1,this.bgTheme=this.tempImg,this.updateBgParameter.bgTheme=this.bgTheme,this.updateBgModel.executeJSONP(this.updateBgParameter,function(t){var i=t.code;~~i?v.showError(t.msg):(e.saveLock=!0,e.setPageBgimg(t.data.bgTheme),e.upload.hide(),f.updateIMUserSig())},function(t){e.saveLock=!0,v.showError("保存背景图出错")}))},setPageBgimg:function(e){e&&this.profileBg.css("background","url("+e+")")}}));e.exports=g},function(e,t,i){"use strict";var n=i(24),s=n.extend({url:"{{url_prefix}}/user/bgtheme_update.json?deviceinfo={{deviceinfo}}&access_token=web-{{access_token}}&bgTheme={{bgTheme}}",beforeEmit:function(e){}});e.exports=s},function(e,t,i){"use strict";var n=i(16),s=i(79),a=i(80),o=i(23),r=o.sharedInstanceIMModel(),l=i(81),c=i(27),d=c.sharedInstanceUserModel(),h=n.extend({el:"#settingProfile",events:{},rawLoader:function(){},beforeMount:function(){this.data={nickName:r.$get("data.nickName"),bigheadImg:r.$get("data.largeAvatar"),anchor:r.$get("data.anchor")},this.userInfoModel=l.sigleInstance(),this.userInfo={}},afterMount:function(){this.elements={}},ready:function(){this.initRender(),this.defineEventInterface()},initRender:function(){var e,t=this.$el,i=this;r.isAnchor()?(e=this.compileHTML(s,this.data),this.$el.html(e),this.elements.nickName=t.find("#nickName"),this.elements.headAvatar=t.find("#headAvatar"),this.elements.tagsWrap=t.find("#tagsWrap")):this.userInfoModel.executeJSONP({deviceinfo:'{"aid": "30001001"}',access_token:d.getWebToken()},function(e){i.bindUserInfo(e)})},bindUserInfo:function(e){var t,i=this,n=this.$el;i.data.gender=e.data.sex||"",t=i.compileHTML(a,i.data),i.$el.html(t),i.elements.watchedLiveCount=n.find("#txtLive"),i.elements.totalCredits=n.find("#txtScore"),i.elements.fanTicket=n.find("#txtTicket"),i.elements.watchedLiveCount.text(0),i.elements.totalCredits.text(e.data.totalMarks||0),i.elements.fanTicket.text(0)},partialRender:function(e){this.elements.nickName.text(e.nickName),this.elements.headAvatar.attr("src",e.headImg);var t="";for(var i in e.tags)t+="<span>"+e.tags[i]+"</span>";this.elements.tagsWrap.html(t)},defineEventInterface:function(){var e=this;Backbone.on("event:userProfileChanged",function(t){e.partialRender(t)})}});e.exports=h},function(e,t){e.exports='<div  class="fl avatorBg">\n	<img style="width: 100p; height: 100px;" id="headAvatar" src="{{bigheadImg}}" alt="">\n</div>\n<div class="fl anchorrMsg">\n	<h2>\n		<span id="nickName" class="fl name">{{nickName}}</span>\n		<span class="fl aPnum">主持直播：<i>{{anchor.liveCount}}</i>场</span>\n	</h2>\n	<p id="tagsWrap">\n		标签：\n		{{each anchor.tags as item}}\n			<span>{{item}}</span>\n		{{/each}}\n	</p>\n</div>'},function(e,t){e.exports='<!-- 普通用户 -->\n<div class="fl avatorBg">\n    <img style="width: 100px; height: 100px;" id="headAvatar" src="{{bigheadImg}}" alt="">\n</div>\n<div class="fl anchorrMsg">\n    <h2>\n        <span id="nickName" class="fl name user-name">{{nickName}}</span>\n        {{if gender == \'Boy\'}}\n        <span class="gender male"></span>\n        {{/if}}\n        {{if gender ==\'Girl\'}}\n        <span class="gender female"></span>\n        {{/if}}\n    </h2>\n    <div class="top-user-info">\n        <span>观看直播:<span id="txtLive" class="black">0</span>次</span>\n        <span>积分:<span id="txtScore" class="black">0</span></span>\n        <span>饭票:<span id="txtTicket" class="black">0</span></span>\n    </div>\n</div>'},function(e,t,i){"use strict";var n=i(24),s=null,a=n.extend({url:"{{url_prefix}}/user/info.json",beforeEmit:function(e){}});a.sigleInstance=function(){return s||(s=new a),s},e.exports=a},function(e,t,i){"use strict";var n=i(16),s=i(83),a=i(27),o=a.sharedInstanceUserModel(),r=i(50),l=i(51),c=i(23),d=c.sharedInstanceIMModel(),h=n.extend({el:"#editProfile",rawLoader:function(){return i(84)},events:{"change #userAvatarForm":"submitFile","keyup .userInfoChanged":"verifyForm","click #btnSave":"saveuserinfo"},beforeMount:function(){this.userUpdateModel=new s},afterMount:function(){var e=this.$el;this.txtImg=$("#txtImg"),this.txtName=$("#txtName"),this.txtTags=$("#txtTags"),this.btnSave=$("#btnSave"),this.btnUploadAvatar=e.find("#btnUploadAvatar"),this.imgUserAvatar=$("#imgUserAvatar")},ready:function(){this.initUploadFile(),this.fetchIMUserInfo()},initForm:function(){var e=this;e.userInfo.smallAvatar&&(e.imgUserAvatar.attr("src",e.userInfo.smallAvatar),e.txtImg.val(e.userInfo.smallAvatar)),e.txtName.val(e.userInfo.nickName);var t=e.userInfo.anchor.tags.join(",")||"";e.txtTags.val(t)},fetchIMUserInfo:function(){var e=this;d.fetchIMUserSig(function(t){e.userInfo=t,e.initForm()})},verifyForm:function(){var e=$.trim(this.txtName.val()),t=/^[0-9A-Za-z\u4e00-\u9fa5]{1,15}$/g,i=$.trim(this.txtTags.val());if(this.btnSave.addClass("m_disabled"),!e||0==e.length)return l.showTip("请输入您的昵称"),!1;if(e.length>30)return l.showTip("昵称长度不能超过15个字!"),!1;if(!t.test(e))return l.showTip("昵称允许包含:中文,数字以及字母!"),!1;i=i.split(/[,，]/);for(var n=[],s=!1,a="",o=i.length;o>=0;o--)a=$.trim(i[o]),a.length>=1&&n.push(a),a.length>5&&(s=!0);return i=n,i&&0!=i.length?s?(l.showTip("每个标签最多5个字,请检查您的标签!"),!1):i.length>5?(l.showTip("您最多输入5个标签,请删掉一些标签"),!1):!this.txtImg.val()||this.txtImg.val().length<=0?(l.showTip("请上传头像图片"),!1):(this.btnSave.removeClass("m_disabled"),!0):(l.showTip("请输入至少一个标签,多个标签请用逗号分隔!"),!1)},tagsFilter:function(e){e=e.split(/[,，]/);for(var t=[],i="",n=e.length;n>=0;n--)i=$.trim(e[n]),i.length>=1&&t.push(i);return t},initUploadFile:function(){var e={cmd:[{saveOriginal:1,op:"save",plan:"avatar",belongId:"20634338",srcImg:"img"}],redirect:"http://"+window.location.host+"/cross-url/upload.html"},t=this;t.upload=r.classInstanceUploadFile({el:$("#userAvatarForm"),url:"http://image.yinyuetai.com/edit",data:e,filename:"img",className:"file",success:function(e){t.changeUploadBtnStatus(),t.fileUploaded(e)},failure:function(){t.changeUploadBtnStatus(),l.showError("上传失败")}})},changeUploadBtnStatus:function(e){e?(this.btnUploadAvatar.parent().addClass("m_disabled"),this.btnUploadAvatar.text("正在上传")):(this.btnUploadAvatar.parent().removeClass("m_disabled"),this.btnUploadAvatar.text("重新上传"))},submitFile:function(){var e=this.btnUploadAvatar.parent();e.hasClass("m_disabled")||(this.changeUploadBtnStatus(!0),this.upload.submit())},fileUploaded:function(e){var t=this.upload.parseErrorMsg(e);if(1==t){var i=e.images[0].path;this.txtImg.val(i),this.imgUserAvatar.attr("src",i),this.verifyForm()}else l.showTip(t)},saveuserinfo:function(){var e=this;if(e.isChanged()&&this.verifyForm()){e.btnSave.text("保存中");var t={deviceinfo:'{"aid": "30001001"}',access_token:"web-"+o.getToken(),nickname:$.trim(e.txtName.val()),headImg:e.txtImg.val(),tags:e.tagsFilter(e.txtTags.val()).join(",")};this.userUpdateModel.executeJSONP(t,function(t){e.btnSave.text("保存"),t&&"0"===t.code?(l.showOK("数据保存成功!"),d.updateIMUserSig(),e.fetchIMUserInfo(),Backbone.trigger("event:userProfileChanged",{nickName:$.trim(e.txtName.val()),headImg:e.txtImg.val(),tags:e.tagsFilter(e.txtTags.val())})):l.showError(t.msg||"数据保存失败,请稍后重试!")},function(t){l.showError("数据保存失败,请稍后重试!"),e.btnSave.text("保存")})}},isChanged:function(){var e=$.trim(this.txtName.val()),t=$.trim(this.txtTags.val()).replace(/[,，]/g,",");return e==this.userInfo.nickName&&t==this.userInfo.anchor.tags.join(",")&&this.txtImg.val()==this.userInfo.smallAvatar?(this.btnSave.addClass("m_disabled"),!1):!0}});e.exports=h},function(e,t,i){"use strict";var n=i(24),s=n.extend({url:"{{url_prefix}}/user/update.json?deviceinfo={{deviceinfo}}&access_token=web-{{accessToken}}&nickname={{nickname}}&headImg={{headImg}}&tags={{tags}}",beforeEmit:function(e){}});e.exports=s},function(e,t){e.exports='<ul>\n    <li class="uploadAvator">\n        <span class="fl PiTitle"><i>*</i>头像：</span>\n        <div class="fl">\n            <img id="imgUserAvatar" data-src="../img/personInfo-uploadBg.png" src="../img/personInfo-uploadBg.png"\n                 alt="" class="fl avatorNow">\n            <div class="uploadform fl">\n                <!-- <form id="ieditAvatar" class="upload-form"></form> -->\n                <!-- <input type="file" name="" class="file"> -->\n                <div class="">\n                    <span id="btnUploadAvatar">上传图片</span>\n                    <form id="userAvatarForm" class="upload-form"></form>\n                </div>\n                <p>支持5M以内的gif、jpg、jpeg、png图片上传</p>\n            </div>\n            <input id="txtImg" type="hidden" value="">\n        </div>\n    </li>\n    <li class="Inp_Pc_name">\n        <span class="fl PiTitle"><i>*</i>昵称：</span>\n        <div class="fl">\n            <input id="txtName" placeholder="昵称" class="userInfoChanged" maxlength="30" type="text">\n            <span style="display: none;" class="tips"><img src="../img/1.jpg" alt="">你的名字里有敏感词，请重新输入 </span>\n        </div>\n    </li>\n    <li class="tags">\n        <span class="fl PiTitle"><i>*</i>标签：</span>\n        <div class="fl">\n            <input id="txtTags" class="userInfoChanged" type="text" placeholder="(多个标签中间请用逗号隔开)">\n            <!--<br>-->\n            <!--<input type="text">-->\n            <!--<br>-->\n            <!--<input type="text">-->\n            <!--<br>-->\n            <!--<input type="text">-->\n            <!--<br>-->\n            <!--<input type="text">-->\n            <!--<br>-->\n            <!--<input type="text">-->\n            <!--<br>-->\n            <div class="light-color">多个标签中间请用逗号隔开,每个标签最多5个字,最多拥有5个标签.</div>\n        </div>\n    </li>\n    <li id="btnSave" class="save m_disabled">保存</li>\n</ul>\n'},function(e,t,i){"use strict";var n=i(16),s=i(86),a=i(33),o=i(51),r=i(26),l=n.extend({el:"#updatePassword",rawLoader:function(){return i(87)},events:{"click #btnPwdSave":"updatePwd","keyup #txtConfirmPwd":"changeBtnStatus","keyup #txtNewPwd":"checkNewPwd"},beforeMount:function(){this.updatePwdModel=new s},afterMount:function(){var e=this.$el;this.txtOldPwd=e.find("#txtOldPwd"),this.txtNewPwd=e.find("#txtNewPwd"),this.txtConfirmPwd=e.find("#txtConfirmPwd"),this.btnPwdSave=e.find("#btnPwdSave"),this.tipPwdErr=e.find("#tipPwdErr"),this.formPwd=e.find("#formPwd")},ready:function(){},verifyForm:function(){var e=this.txtOldPwd.val();if(!e||e.length<=0)return o.showTip("请输入您当前的密码"),!1;var t=this.txtNewPwd.val(),i=/[\S]{4,20}/;if(!t||t.length<=0)return o.showTip("请输入新的密码"),!1;if(t==e)return o.showTip("新密码不能跟旧密码一致"),!1;if(!i.test(t))return o.showTip("密码的长度建议4~20位,允许输入字母、数字、符号"),!1;var n=this.txtConfirmPwd.val();return t!=n?(o.showTip("2次输入的新密码不一致!"),!1):!0},changeBtnStatus:function(){var e=this.txtNewPwd.val(),t=this.txtConfirmPwd.val();e!=t?this.btnPwdSave.addClass("m_disabled"):this.btnPwdSave.removeClass("m_disabled")},updatePwd:function(){var e=this;return e.verifyForm()?(this.btnPwdSave.text("保存中"),this.initAjaxForm(),void this.formPwd.submit()):null},checkNewPwd:function(){var e=this.txtOldPwd.val(),t=this.txtNewPwd.val();e===t?this.tipPwdErr.show():this.tipPwdErr.hide()},resetInput:function(){this.formPwd.find("input").val("")},initAjaxForm:function(){var e=this;this.pwdAjaxForm=a.classInstanceAjaxForm($("#formPwd"),{success:function(t){var i=this.contentWindow,n=(i.location,decodeURIComponent(i.location.search)),s=r.parseSearch(n);s=s.json,s&&1==s.error?o.showError(s.message):(e.resetInput(),o.showOK("密码修改成功!")),e.btnPwdSave.text("保存")},failure:function(t){o.showError("密码修改失败!"),e.btnPwdSave.text("保存")}}),this.pwdAjaxForm.setIframeState(!0)}});e.exports=l},function(e,t){"use strict";function i(){}i.prototype.save=function(e,t,i){$.ajax("http://i.yinyuetai.com/i/profile/update-password",{method:"POST",data:e,success:function(e){t&&t(e)},error:function(e){i&&i(e)}})},e.exports=i},function(e,t){e.exports='<form id="formPwd" action="http://i.yinyuetai.com/i/profile/update-password" method="post">\n    <ul>\n        <li class="Inp_Pc_name">\n            <span class="fl PiTitle"><i>*</i>旧密码：</span>\n            <div class="fl">\n                <input id="txtOldPwd" name="oldPassword" placeholder="请输入旧密码" type="password">\n            </div>\n        </li>\n        <li class="Inp_Pc_name">\n            <span class="fl PiTitle"><i>*</i>新密码：</span>\n            <div class="fl">\n                <input id="txtNewPwd" name="newPassword" placeholder="请输入新密码" type="password"><span id="tipPwdErr" style="display: none;color:red; padding-left: 5px;">新密码不能跟旧密码一致</span>\n            </div>\n        </li>\n        <li class="Inp_Pc_name">\n            <span class="fl PiTitle"><i>*</i>确认新密码：</span>\n            <div class="fl">\n                <input id="txtConfirmPwd" name="newPasswordRepeat" placeholder="请再次输入新密码" type="password">\n            </div>\n        </li>\n        <li class="save m_disabled" id="btnPwdSave">\n            保存\n        </li>\n    </ul>\n</form>\n'},function(e,t,i){"use strict";var n=i(16),s=i(89),a=i(93),o=i(102),r=i(105),l=i(108),c=i(41),d=i(25),h=i(26),u=i(23),p=u.sharedInstanceIMModel(),f=n.extend({el:"#pageContent",rawLoader:function(){return i(112)},events:{"click #tab-menu-ctrl>li":"menuChanged","click #liveState>li":"liveStateChanged","click #profileSate>li":"profileStateChanged"},beforeMount:function(){this.menuList={list:[]},this.initMenu()},afterMount:function(){this.noListDOM=this.$el.find("#noOpenListLive"),this.historyDOM=this.$el.find("#historyListLive"),this.liveStateDOMS=this.$el.find("#liveState>li"),this.editProfileDOM=this.$el.find("#editProfile"),this.accountSettingsDOM=this.$el.find("#accountSettings"),this.profileStateDOMS=this.$el.find("#profileSate>li"),this.updatePasswordDom=this.$el.find("#updatePassword"),this.menuWrap=this.$el.find("#tab-menu-ctrl"),this.menuTpl=this.$el.find("#menuTpl").text()},ready:function(){this.initMenu(),p.isAnchor()&&(this.noopenListView=new a,this.historyListView=new o,this.createLiveView=new s),this.followingView=new l,this.recordListView=new r;var e=h.parse(window.location.href).query.view||"";this.changeView(e)},menuChanged:function(e){var t=$(e.target);"SPAN"==e.target.tagName&&(t=t.parent()),t&&("signout"===t.attr("data-panel")?c.show({content:"是否退出",okFn:function(){d.remove("imSig"),d.set("signout",1),window.location.href="/web/login.html"}}):(t.parent().children("li").removeClass("on"),t.addClass("on"),$(".tab-panel").hide(),$("#"+t.attr("data-panel")).show()))},liveStateChanged:function(e){var t=$(e.currentTarget),i=t.data("state");this.liveStateDOMS.removeClass("on"),t.addClass("on"),~~i?(this.noListDOM.hide(),this.historyDOM.show()):(this.historyDOM.hide(),this.noListDOM.show())},profileStateChanged:function(e){var t=$(e.currentTarget),i=t.data("state");this.profileStateDOMS.removeClass("on"),t.addClass("on"),~~i?(this.editProfileDOM.hide(),this.updatePasswordDom.show()):(this.editProfileDOM.show(),this.updatePasswordDom.hide())},changeView:function(e){"history"==e&&this.liveStateChanged({currentTarget:$(".myLiveControls").find('[data-state="1"]')})},initMenu:function(){if(p.isAnchor()?(this.menuList.list=[{name:"我的直播",pannel:"tab-my-live",active:!0},{name:"创建直播",pannel:"createLiveVideo"},{name:"观看记录",pannel:"recordList",active:!0},{name:"我的关注",pannel:"followingList"}],this.menuList.list.push({name:"个人设置",pannel:"tabSetting"})):this.menuList.list=[{name:"观看记录",pannel:"recordList",active:!0},{name:"我的关注",pannel:"followingList"}],this.menuList.list.push({name:"退出",pannel:"signout"}),this.menuTpl){var e=this.compileHTML(this.menuTpl,this.menuList);this.menuWrap.html(e),this.menuWrap.children(":first").click()}}});e.exports=f},function(e,t,i){"use strict";var n,s=i(16),a=i(57),o=i(27),r=o.sharedInstanceUserModel(),l=i(90),c=i(91),d=i(51),h=s.extend({el:"#createLiveVideo",rawLoader:function(){return i(92)},events:{"click #createVideo":"createVideoHandler","click .select":"dateTimeToggle","click .selectDate li":"selectDateHandler","keyup #inputActorName":"actorNameHandler","blur #inputActorName":"actorNameBlurHandler","click #selectorActor li":"selectorActorHandler","change #inputActorName":""},beforeMount:function(){this.actorName=null,this.videoName=null,this.createClick=!1,this.createLock=!0,this.dateTime=new a,this.mapKey=["year","month","day","hours","minutes"],this.createData={deviceinfo:'{"aid":"30001001"}',roomName:"",roomDesc:"",artistId:"",artistName:"",liveTime:0,access_token:"web-"+r.getToken()},this.createDate={}},afterMount:function(){this.selectorActor=this.$el.find("#selectorActor"),this.actorTemp=this.$el.find("#selectorActorTemp").html(),this.createVideo=this.$el.find("#createVideo"),this.actorName=this.$el.find("#inputActorName"),this.videoName=this.$el.find("#liveVideoName"),this.liveTime=this.$el.find("#liveTime"),this.liveTimeTemp=this.$el.find("#liveTimeTemp").html(),this.cellsTemp=this.$el.find("#cellsTemp").html(),this.hours=this.compileHTML(this.cellsTemp,{cells:this.eachMost(0,23)}),this.minutes=this.compileHTML(this.cellsTemp,{cells:this.eachMost(0,59)})},ready:function(){this.artistModel=new c,this.createModel=new l,this.initRender(),this.initListener()},initRender:function(){var e=this.dateDataStructure(),t=this.compileHTML(this.liveTimeTemp,{items:e});this.liveTime.html(t),this.liveTimeUl=this.liveTime.find(".select>ul"),this.liveTimeSpan=this.liveTime.find(".date"),this.liveLength=this.liveTimeUl.length-1},initListener:function(){var e=this;n=setInterval(function(){var t=e.actorName.val(),i=e.videoName.val();t&&i?(e.createVideo.removeClass("m_disabled"),e.createClick=!0):(t||i)&&(e.createVideo.addClass("m_disabled"),e.createClick=!1)},0)},dateDataStructure:function(){for(var e=[],t=0,i=this.mapKey.length;i>t;t++){var n=this.mapKey[t],s={tag:n,cur:this.dateTime.$get(n),style:""};switch(this.createDate[n]=s.cur,n){case"year":s.cells=this.dateTime.ceilYear(0),s.name="年";break;case"month":s.cells=this.dateTime.downMonth(),s.name="月";break;case"day":s.cells=this.dateTime.downDay(),s.name="日",s.division=!0;break;case"hours":s.style="margin-left: 68px;",s.cells=this.dateTime.downHours(),s.name="时";break;default:s.cells=this.dateTime.downMinutes(),s.name="分"}e.push(s)}return e},dateTimeToggle:function(e){e.stopPropagation();var t=$(e.currentTarget),i=~~t.data("index"),n=$(this.liveTimeUl[i]);n.toggle()},selectDateHandler:function(e){var t=$(e.currentTarget),i=t.text(),n=t.parent(),s=~~n.data("index"),a=n.data("tag"),o=$(this.liveTimeSpan[s]),r=o.text();if(r!==i){i=~~i,o.text(i),this.createDate[a]=i;var l,c,d,h,u=s+1,p=1,f=0;for("month"===a&&i===this.dateTime.$get("month")&&(this.dateTime.setCurNewDate(),d=!0);u<=this.liveLength;u++){var m=$(this.liveTimeUl[u]),v=$(this.liveTimeSpan[u]),g=m.data("tag");if(h=null,d)h=this.dateTime.down(g),l=this.compileHTML(this.cellsTemp,{cells:h}),v.text(h[0]),m.html(l);else switch(g){case"day":c=this.dateTime.getCountDays(i),l=this.compileHTML(this.cellsTemp,{cells:this.eachMost(1,c)}),v.text(p),m.html(l);break;case"hours":m.html(this.hours),v.text(f);break;default:m.html(this.minutes),v.text(f)}}}},eachMost:function(e,t){for(var i=[];t>=e;e++)i.push(e);return i},actorNameHandler:function(e){var t=$(e.currentTarget),i=$.trim(t.val());if(!i)return void this.selectorActor.empty();var n=this;this.artistModel.executeJSONP({keyword:i,deviceinfo:'{"aid":"30001001"}'},function(e){var t=e.data.list;n.selectorActor.html(n.compileHTML(n.actorTemp,{items:t})),n.selectorActor.show()},function(e){d.showError("输入有误")})},actorNameBlurHandler:function(e){},selectorActorHandler:function(e){var t=$(e.currentTarget),i=t.text();this.createData.artistId=~~t.attr("data-id"),this.actorName.val(i),this.selectorActor.hide()},createVideoHandler:function(e){var t=this;if(this.createClick&&this.createLock){clearInterval(n);var i=new Date,s=i.getTime()+36e5;if(this.createLock=!1,this.createData.roomName=this.videoName.val(),this.createData.artistName=this.actorName.val(),this.createData.liveTime=this.dateTime.getTime(this.createDate),this.createData.liveTime<s)return d.showError("直播时间至少为一小时之后"),this.createLock=!0,void t.initListener();this.createModel.executeJSONP(this.createData,function(e){var i=~~e.code;e.data;i?(d.showError(e.msg),t.createLock=!0,t.initListener()):(d.showOK("创建成功"),window.location.reload())},function(e){d.showError("创建失败"),t.createLock=!0,t.initListener()})}}});e.exports=h},function(e,t,i){"use strict";var n=i(24),s=n.extend({url:"{{url_prefix}}/room/create.json?deviceinfo={{deviceinfo}}&access_token=web-{{access_token}}&roomName={{roomName}}&roomDesc={{roomDesc}}&artistId={{artistId}}&liveTime={{liveTime}}",
beforeEmit:function(e){}});e.exports=s},function(e,t,i){"use strict";var n=i(24),s=n.extend({url:"{{url_prefix}}/search/artist_autocomplete.json?deviceinfo={{deviceinfo}}&keyword={{keyword}}&offset=100",beforeEmit:function(e){}});e.exports=s},function(e,t){e.exports='<ul>\n	<li class="Inp_name">\n		<span>*</span>直播名称：\n		<input type="text" maxlength="15" placeholder="输入直播名" id="liveVideoName"><i style="margin-left: 16px;">限15个字以内</i>\n	</li>\n	<li class="Inp_artist">\n		<span>*</span>选择艺人：\n		<input type="text" placeholder="输入文字" id="inputActorName">\n		<ul id="selectorActor">\n			 <script type="text/html" id="selectorActorTemp">\n				{{each items as item}}\n				      <li data-id="{{item[0]}}">{{item[1]}}</li>\n				{{/each}}\n			 </script>\n		</ul>\n	</li>\n	<li class="Inp_time">\n		<div class="tit"><span class="redX">*</span>直播时间：</div>\n		<div id="liveTime">\n			<script type="text/html" id="liveTimeTemp">\n				{{each items as item i}}\n					<div class="select" style="{{item.style}}" data-index="{{i}}">\n						<span class="date">{{item.cur}}</span>\n						<img src="../img/select-ico.jpg" alt="">\n						<ul class="selectDate" data-index="{{i}}" data-tag="{{item.tag}}">\n							{{each item.cells as cell}}\n								<li>{{cell}}</li>\n							{{/each}}\n						</ul>\n					</div>\n					<em>{{item.name}}</em>\n					{{if item.division}}\n						<br/>\n					{{/if}}\n				{{/each}}\n			</script>\n			<script type="text/html" id="cellsTemp">\n				{{each cells as cell}}\n					<li>{{cell}}</li>\n				{{/each}}\n			</script>\n		</div>\n\n	</li>\n	<div class="submit m_disabled" id="createVideo">创建</div>\n</ul>\n'},function(e,t,i){"use strict";var n=i(16),s=i(94),a=i(95),o=i(96),r=i(97),l=i(98),c=i(51),d=i(41),h=i(27),u=i(47),p=i(57),f=h.sharedInstanceUserModel(),m=new p,v=n.extend({el:"#noOpenContent",events:{"click li":"checkLiveVideoHandler","click .uploadImage":"editCoverImageHandler","click .copy-video-url":"copyUrlHandler","click .copy-video-name":"copyNameHandler"},rawLoader:function(){},beforeMount:function(){var e=f.getToken();this.listTemp=i(100),this.liTemp=i(101),this.noOpenParameter={deviceinfo:'{"aid":"30001001"}',order:"time",offset:0,size:6,access_token:"web-"+e},this.removeParameter={deviceinfo:'{"aid":"30001001"}',roomId:"",access_token:"web-"+e},this.releaseParameter={deviceinfo:'{"aid":"30001001"}',roomId:"",access_token:"web-"+e},this.saveCoverParameter={deviceinfo:'{"aid":"30001001"}',access_token:"web-"+e,roomId:"",posterUrl:""},this.removeLock=!0,this.releaseLock=!0,this.liCache=null,this.imagePath="",this.upload=null,this.singleLiDOM=null,this.uploadState=!1,this.noOpenModel=new s,this.releaseModel=new a,this.removeModel=new o,this.saveCoverModel=new r},afterMount:function(){},ready:function(){var e=this,t={width:580,height:341,isRemoveAfterHide:!1,isAutoShow:!1,mainClass:"shadow_screen_x",closeClass:"editor_bg_close_x",closeText:"X",title:"封面设置",ctrlData:{cmd:[{saveOriginal:1,op:"save",plan:"avatar",belongId:"20634338",srcImg:"img"}],redirect:"http://"+window.location.host+"/cross-url/upload.html"},uploadFileSuccess:function(t){e.uploadImageHandler(t),e.uploadState=!0},saveFile:function(){e.uploadState?e.saveCoverImage():c.showTip("正在上传，请等待")}};this.upload=new u(t),this.noOpenModel.executeJSONP(this.noOpenParameter,function(t){var i=t.data,n=i.roomList,s=Math.ceil(i.totalCount/e.noOpenParameter.size);s>1&&e.initPageBox({offset:e.noOpenParameter.offset,size:e.noOpenParameter.size,count:s}),e.initRender(n)},function(){c.showError("获取未直播列表：第1页失败")})},initPageBox:function(e){var t=this;this.pageBoxView=new l({id:"#noOpenPageBox",props:e,listModel:this.noOpenModel,listRender:function(e){var i=e.data,n=i.roomList;t.initRender(n)}})},initRender:function(e){var t="";t=e.length?this.compileHTML(this.listTemp,{items:e}):"<h1>暂无数据</h1>",this.$el.html(t),this.liCache=null,this.liCache={};for(var i=this.$el.find("li"),n=0,s=i.length;s>n;n++){var a=$(i[n]),o=a.attr("data-key");this.liCache[o]=a}},checkLiveVideoHandler:function(e){var t=this,i=$(e.currentTarget),n=$(e.target),s=n.data("state"),a=i.attr("data-id"),o=n.parents("li").attr("data-img");switch(s){case 2:t.publishLiveShow(a,n,o);break;case 3:this.removeLock&&d.show({content:"是否确认删除",okFn:function(){t.removeLock=!1,t.removeParameter.roomId=a,t.removeModel.executeJSONP(t.removeParameter,function(){t.removeLock=!0,c.showOK("删除成功"),i.remove()},function(e){t.removeLock=!0,c.showError("删除失败")})}})}},isTooLate:function(e){var t=new Date,i=e-t.getTime(),n=Number(p.difference(Math.abs(i)).hours);return 0>i&&n>=1},publishLiveShow:function(e,t,i){var n=this,s=t.parents("li").attr("data-liveTime");if("disable"!==t.attr("class"))return n.isTooLate(s)?(c.showTip("您已经迟到超过一小时，无法再进行本场直播了"),null):void(this.releaseLock&&i?(this.releaseLock=!1,this.releaseParameter.roomId=e,this.releaseModel.executeJSONP(this.releaseParameter,function(e){n.releaseLock=!0,t.addClass("disable"),c.showOK("发布成功");var i=e.data;i.liCacheKey=i.id+"-"+i.streamName,i.liveVideoTime=n.forMatterDate(i.liveTime),i.lookUrl="/web/anchor.html?roomId="+i.id,n.liRender(i)},function(e){n.releaseLock=!0,c.showError("发布失败")})):c.showError("发布失败，请上传封面"))},editCoverImageHandler:function(e){var t=$(e.currentTarget),i=null,n=t.attr("data-posterpic");if(this.upload){if(this.currentLiveItem=$(t.parents("li")),this.singleLiDOM=t.parent(),this.saveCoverParameter.roomId=this.singleLiDOM.data("id"),this.upload.emptyValue(),n){var s=t.find(".cover-image");i={breviaryUrl:s.attr("src"),inputText:"编辑图片"}}this.upload.show(i)}},uploadImageHandler:function(e){var t=this.upload.parseErrorMsg(e);if(1==t){var i=e.images;this.imagePath=i[0].path,this.currentLiveItem&&this.currentLiveItem.attr("data-img",i[0].path||"")}else c.showTip(t)},saveCoverImage:function(){var e=this;this.saveCoverParameter.posterUrl=this.imagePath,this.saveCoverModel.executeJSONP(this.saveCoverParameter,function(t){var i=~~t.code;if(!i){var n=e.singleLiDOM.find(".cover-image");n.attr("src",e.imagePath),e.singleLiDOM=null,c.showOK("保存成功"),e.upload.hide(),e.uploadState=!1}},function(e){c.showError("保存失败")})},forMatterDate:function(e){m.setCurNewDate(e);var t=m.$get("year"),i=m.$get("month"),n=m.$get("day"),s=m.$get("hours"),a=10>s?"0"+s:s,o=m.$get("minutes"),r=10>o?"0"+o:o;return t+"/"+i+"/"+n+" "+a+":"+r},liRender:function(e){var t=this.compileHTML(this.liTemp,{item:e}),i=this.liCache[e.liCacheKey];i.html(t)},copyUrlHandler:function(e){e.preventDefault();var t=$(e.currentTarget),i=t.attr("data-value");return i.length?void this.clipboard(i):void c.showTip("开启直播后生成视频地址")},copyNameHandler:function(e){e.preventDefault();var t=$(e.currentTarget),i=t.attr("data-value");this.clipboard(i)},clipboard:function(e){window.clipboardData?(window.clipboardData.clearData("text"),window.clipboardData.setData("text",e),c.showOK("复制成功")):c.showTip("你浏览器的js不支持剪贴板，无法调用")}});e.exports=v},function(e,t,i){"use strict";var n=i(24),s=i(57),a=new s,o=n.extend({url:"{{url_prefix}}/room/no_open_list.json?deviceinfo={{deviceinfo}}&access_token=web-{{access_token}}&order={{order}}&offset={{offset}}&size={{size}}",beforeEmit:function(e){},formatter:function(e){var t=~~e.code;if(t)return e;for(var i=e.data,n=i.roomList,s=n.length;s--;){var o=n[s],r=o.liveTime;a.setCurNewDate(r);var l=a.$get("year"),c=a.$get("month"),d=a.$get("day"),h=a.$get("hours"),u=10>h?"0"+h:h,p=a.$get("minutes"),f=10>p?"0"+p:p;o.liveVideoTime=l+"/"+c+"/"+d+" "+u+":"+f,o.lookUrl="/web/anchor.html?roomId="+o.id,o.liCacheKey=o.id+"-"+o.streamName}return e}}),r=null;o.sharedInstanceNoOpenListModel=function(){return r||(r=new o),r},e.exports=o},function(e,t,i){"use strict";var n=i(24),s=n.extend({url:"{{url_prefix}}/room/show.json?deviceinfo={{deviceinfo}}&access_token=web-{{access_token}}&roomId={{roomId}}",beforeEmit:function(e){}});e.exports=s},function(e,t,i){"use strict";var n=i(24),s=n.extend({url:"{{url_prefix}}/room/del.json?deviceinfo={{deviceinfo}}&access_token=web-{{access_token}}&roomId={{roomId}}",beforeEmit:function(e){}});e.exports=s},function(e,t,i){"use strict";var n=i(24),s=n.extend({url:"{{url_prefix}}/room/pp_set.json?deviceinfo={{deviceinfo}}&access_token=web-{{access_token}}&roomId={{roomId}}&posterUrl={{posterUrl}}",beforeEmit:function(e){}});e.exports=s},function(e,t,i){"use strict";var n='{{each items as item i}}<span class="{{if item == num }}now{{/if}}" data-page="{{item}}" data-indice="{{i}}">{{item}}</span>{{/each}}',s=i(16),a=i(27),o=i(51),r=a.sharedInstanceUserModel(),l=s.extend({clientRender:!1,events:{"click .pre":"preHandler","click .next":"nextHandler","click #nav span":"pageboxHandler"},beforeMount:function(){var e=this._ICEOptions.props;this.boxTemp=i(99),this.count=e.count,this.offset=e.offset||0,this.size=e.size,this.sectionBase=e.sectionBase||3,this.listModel=this._ICEOptions.listModel,this.listRender=this._ICEOptions.listRender,this.modelParameter={deviceinfo:'{"aid":"30001001"}',order:"",offset:0,size:this.size,access_token:"web-"+r.getToken()},this.omit=this.count>2,this.items=[];for(var t=0;t<this.count;t++)this.items.push(t+1);this.lock=!0,this.translation=0},afterMount:function(){},ready:function(){this._ICEinitEvent(),this.initRender(),this.pageChanged(),this.initEvent()},initRender:function(){var e=this.items.concat();this.omit&&(e=e.splice(0,3));var t={count:this.count,omit:this.omit,items:e,preOmit:this.preOmit},i=this.compileHTML(this.boxTemp,t);this.$el.html(i),this.howPage=this.$el.find("#howPage"),this.nav=this.$el.find("#nav"),this.tipPreOmit=this.$el.find("#tipPreOmit"),this.tipOmit=this.$el.find("#tipOmit")},preHandler:function(e){var t=$(e.currentTarget);if(this.offset<=0)return void o.showTip("原因：已经翻到最前一页");var i=t.attr("data-state");this.initRequest(i)},nextHandler:function(e){var t=$(e.currentTarget);if(this.offset===this.count-1)return void o.showTip("原因：已经翻到最后一页");var i=t.attr("data-state");this.initRequest(i)},pageboxHandler:function(e){var t=$(e.currentTarget);if(t.attr("data-page")){var i=~~t.attr("data-page");if(i-1!==this.offset){var n=this.nav.find("span");n.removeClass("now"),t.addClass("now");var s=~~t.text();this.offset=s-1,this.translation=~~t.attr("data-indice"),this.openRequest()}}},initRequest:function(e){switch(e){case"1":0!==this.offset&&(this.offset--,this.sectionLogic(0));break;case"2":this.offset<=this.count-2&&(this.offset++,this.sectionLogic(1))}this.openRequest()},openRequest:function(){var e=this;this.lock&&(this.lock=!1,this.modelParameter.offset=(this.offset||0)*this.size,this.listModel.executeJSONP(this.modelParameter,function(t,i){e.lock=!0;var n=~~t.code;return n?void o.showError(t.msg):void e.listRender(t)},function(t){e.lock=!0,0!==e.offset&&e.offset--}))},sectionLogic:function(e){var t=this.sectionBase-1,i=this.offset+t,n=this.items.concat(),s=n[i];if(s<=n[n.length-1])this.translation=0,n=n.splice(this.offset,this.sectionBase),this.sectionRender(n,n[0]);else{if(!s){var a=this.offset?this.offset-1:this.offset;this.offset>this.count-2&&a&&--a;var o=n.splice(a,this.sectionBase);return this.translation=0,void this.sectionRender(o,this.offset+1)}if(this.translation>t)return;e?this.translation++:this.translation--,this.spans.removeClass("now");var r=this.spans[this.translation];$(r).addClass("now")}},sectionRender:function(e,t){var i=this.compileHTML(n,{items:e,num:t,preOmit:this.preOmit,omit:this.omit});this.nav.html(i),this.spans=this.nav.find("span"),Backbone.trigger(this.cid+"event:listPageChanged")},pageChanged:function(){var e=this;e.offset>2?this.tipPreOmit.show():this.tipPreOmit.hide(),e.count<4||e.offset+3>=e.count?this.tipOmit.hide():this.tipOmit.show()},initEvent:function(){var e=this;Backbone.on(this.cid+"event:listPageChanged",function(t){e.pageChanged(t)})}});e.exports=l},function(e,t){e.exports='<span class="pre" data-state="1">&lt;</span>\n<span id=\'tipPreOmit\' style="display: none;" class="disabled">...</span>\n<div class="fl">\n	<div id="nav">\n		{{each items as item i}}\n			<span class="{{if i === 0}}now{{/if}}" data-page="{{item}}" data-indice="{{i}}">{{item}}</span>\n		{{/each}}\n	</div>\n</div>\n<!-- {{if omit}} -->\n<span id=\'tipOmit\' class="disabled" style="display: none;">...</span>\n<!-- {{/if}} -->\n<span class="next" data-state="2">&gt;</span>\n<p>共<i id="howPage">{{count}}</i>页</p>\n'},function(e,t){e.exports='{{each items as item}}\n     <li  data-id="{{item.id}}" data-key="{{item.liCacheKey}}" data-img="{{item.posterPic}}" data-liveTime="{{item.liveTime}}">\n            <div class="uploadAd fl uploadImage" data-posterPic="{{if item.posterPic}}1{{/if}}">\n                   <img src="{{item.posterPic || \'../img/aP-list-ad.jpg\'}}" alt="" class="cover-image">\n            </div>\n            <dl class="preLiveMsg fl">\n                   <dt>{{item.roomName}}</dt>\n                   <dd>直播时间：<span>{{item.liveVideoTime}}</span></dd>\n                   <dd>\n                        <h4 class="tit">视频连接：</h4>\n                        <div>\n                                <span>{{item.livePushStreamUrl}}</span>\n                                <a href="" class="copy copy-video-url" data-value="{{item.livePushStreamUrl}}">复制</a>\n                        </div>\n                   <dd>\n                        <h4 class="tit">视频流：</h4>\n                        <div>\n                              <span>{{item.streamName}}</span>\n                              <a href="" class="copy copy-video-name" data-value="{{item.streamName}}">复制</a>\n                        </div>\n                  </dd>\n                   <dd class="ctl">\n                        <a href="{{item.lookUrl}}">查看</a>\n                        {{if item.status === 1}}\n                        	<span class="disable" data-state="2">已发布</span>\n                        {{else if item.status === 2}}\n                            <span class="disable">直播中</span>\n                        {{else }}\n                        	{{if item.status === 0}}\n                        		<span  data-state="2">发布</span>\n					        {{/if}}\n                        {{/if}}\n                        {{if item.status === 0}}\n                            <span data-state="3">删除</span>\n                        {{/if}}\n                   </dd>\n            </dl>\n     </li>\n{{/each}}\n'},function(e,t){e.exports='<div class="uploadAd fl uploadImage"data-posterPic="{{if item.posterPic}}1{{/if}}"  data-liveTime="{{item.liveTime}}">\n       <img src="{{item.posterPic|| \'../img/aP-list-ad.png\'}}" alt="" class="cover-image">\n</div>\n<dl class="preLiveMsg fl">\n       <dt>{{item.roomName}}</dt>\n       <dd>直播时间：<span>{{item.liveVideoTime}}</span></dd>\n       <dd>\n            <h4 class="tit">视频连接：</h4>\n            <div>\n                    <span>{{item.livePushStreamUrl}}</span>\n                    <a href="" class="copy copy-video-url" data-value="{{item.livePushStreamUrl}}">复制</a>\n            </div>\n       <dd>\n            <h4 class="tit">视频流：</h4>\n            <div>\n                  <span>{{item.streamName}}</span>\n                  <a href="" class="copy copy-video-name" data-value="{{item.streamName}}">复制</a>\n            </div>\n      </dd>\n       <dd class="ctl">\n            <a href="{{item.lookUrl}}">查看</a>\n            {{if item.status === 1}}\n            	<span class="disable" data-state="2">已发布</span>\n            {{else }}\n            	{{if item.status === 0}}\n            		<span  data-state="2">发布</span>\n			    {{/if}}\n            {{/if}}\n            {{if item.status === 0}}\n                <span data-state="3">删除</span>\n            {{/if}}\n       </dd>\n</dl>\n'},function(e,t,i){"use strict";var n=i(16),s=i(103),a=i(98),o=i(27),r=o.sharedInstanceUserModel(),l=n.extend({el:"#historyContent",events:{},rawLoader:function(){},beforeMount:function(){var e=r.getToken();this.listTemp=i(104),this.historyParameter={deviceinfo:'{"aid":"30001001"}',order:"time",offset:0,size:6,access_token:"web-"+e},this.historyModel=new s},afterMount:function(){},ready:function(){var e=this;this.historyModel.executeJSONP(this.historyParameter,function(t){var i=t.data,n=i.roomList||[],s=Math.ceil(i.totalCount/e.historyParameter.size);s>1&&e.initPageBox({offset:e.historyParameter.offset,size:e.historyParameter.size,count:s}),e.initRender(n)},function(e){})},initPageBox:function(e){var t=this;this.pageBoxView=new a({id:"#historyPageBox",props:e,listModel:this.historyModel,listRender:function(e){var i=e.data,n=i.roomList;t.initRender(n)}})},initRender:function(e){var t="";t=e.length?this.compileHTML(this.listTemp,{items:e}):"<h1>暂无数据</h1>",this.$el.html(t)}});e.exports=l},function(e,t,i){"use strict";var n=i(24),s=i(57),a=new s,o=n.extend({url:"{{url_prefix}}/room/end_list.json?deviceinfo={{deviceinfo}}&access_token=web-{{access_token}}&order={{order}}&offset={{offset}}&size={{size}}",beforeEmit:function(e){},formatter:function(e){var t=~~e.code;if(t)return e;for(var i=e.data,n=i.roomList,o=n.length;o--;){var r=n[o],l=s.difference(r.duration>0?r.duration:0);r.diff=l.hours+":"+l.minutes+":"+l.seconds;var c=r.liveTime;a.setCurNewDate(c);var d=a.$get("year"),h=a.$get("month"),u=a.$get("day"),p=a.$get("hours"),f=10>p?"0"+p:p,m=a.$get("minutes"),v=10>m?"0"+m:m;r.liveVideoTime=d+"/"+h+"/"+u+" "+f+":"+v}return e}});e.exports=o},function(e,t){e.exports='{{each items as item}}\n<li data-id="{{item.roomId}}">\n    <div class="uploadAd fl">\n        <a href="#">\n            <img src="{{item.posterPic}}" alt="">\n        </a>\n    </div>\n    <dl class="preLiveMsg fl">\n        <dt>{{item.roomName}}</dt>\n        <dd>\n            直播时间：<span class="date dark-color">{{item.liveVideoTime}}</span>\n            时长：<span class="dark-color">{{item.diff}}</span>\n        </dd>\n        <dd class="popularity">\n            <img src="../img/easy.png" alt="">\n            <span>{{item.seen}}</span>\n            <img src="../img/yun.png" alt="">\n            <span>{{item.bulletCurtain}}</span>\n            <img src="../img/love.png" alt="">\n            <span>{{item.assemble}}</span>\n        </dd>\n        <!--<dd class="popularity-wrap">-->\n            <!--<div class="progress-wrap border-radius">-->\n                <!--<div style="width: 45%;" class="progress border-radius"></div>-->\n            <!--</div>-->\n        <!--</dd>-->\n        <dd class="pop">人气：<span>{{item.popularity}}</span></dd>\n    </dl>\n</li>\n{{/each}}'},function(e,t,i){"use strict";var n=i(16),s=i(23),a=(s.sharedInstanceIMModel(),i(57)),o=i(27),r=o.sharedInstanceUserModel(),l=i(106),c=n.extend({el:"#recordList",rawLoader:function(){return i(107)},events:{},beforeMount:function(){this.watchRecordModel=l.sigleInstance(),this.params={deviceinfo:'{"aid": "30001001"}',access_token:r.getWebToken(),size:6,offset:0}},afterMount:function(){this.recordTpl=this.$el.find("#recordTpl").text(),this.recordList=this.$el.find("#recordList")},ready:function(){this.initPagination()},initPagination:function(e){var t=this;this.pageing=$("#page-wrap").paging(e||1,{format:"[ < .(qq -) nnncnn (- pp)> ] ",perpage:6,onFormat:function(e){switch(e){case"block":return this.active?this.value!=this.page?'<a href="#'+this.value+'">'+this.value+"</a>":'<span class="current ">'+this.value+"</span>":'<span class="disabled ">'+this.value+"</span>";case"next":return this.active?'<a href="#'+this.value+'" class="next ">&raquo;</a>':'<span class="disabled ">&raquo;</span>';case"prev":return this.active?'<a href="#'+this.value+'" class="prev ">&laquo;</a>':'<span class="disabled ">&laquo;</span>';case"fill":return this.active?"<span>...</span>":""}return""},onSelect:function(e){t.getPageList(e)}})},getPageList:function(e){var t=this;this.params.offset=6*(e-1),t.watchRecordModel.executeJSONP(this.params,function(e){t.renderList(e),!t.totalCount&&e.data.totalCount&&(t.totalCount=e.data.totalCount,t.pageing.setNumber(t.totalCount),t.pageing.setPage())},function(){t.pageing.setNumber(1),t.pageing.setPage()})},renderList:function(e){var t=this.formatData(e),i=this.compileHTML(this.recordTpl,t);this.recordList.html(i)},formatData:function(e){return e&&_.each(e.data.rooms,function(e){if(e.startTime){var t=new Date(e.startTime);e.startTimeTxt=t.Format("yyyy/MM/dd")}var i=a.difference(e.duration);e.durationTxt=i.hours+":"+i.minutes+":"+i.seconds}),e}});e.exports=c},function(e,t,i){"use strict";var n=i(24),s=null,a=n.extend({url:"{{url_prefix}}/history/room/list.json?deviceinfo={{deviceinfo}}&access_token={{access_token}}&offset={{offset}}&size={{size}}",beforeEmit:function(e){}});a.sigleInstance=function(){return s||(s=new a),s},e.exports=a},function(e,t){e.exports='<div class="record-wrap">\n    <div id="recordList">\n        加载中...\n    </div>\n    <!---->\n    <script type="text/x-template" id="recordTpl">\n        {{each data.rooms as item}}\n        <div class="item">\n            <div class="line">\n                <span class="point"></span>\n                <span class="date">{{item.startTimeTxt}}</span>\n            </div>\n            <div class="content">\n                <a href="###" class="img-wrap Left">\n                    <img src="{{item.posterPic}}" onerror="src=\'../img/bg-demo.jpg\'"\n                         alt=""></a>\n                <div class="info-wrap Left">\n                    <div class="item-title">{{item.roomName}}</div>\n                    <div class="time">时长: <span class="">{{item.durationTxt}}</span></div>\n                    <div class="anchor">\n                        <img src="{{item.creator.smallAvatar}}" onerror="this.src=\'../img/bg-demo.jpg\'" alt="">\n                        <a class="name" href="##">{{item.creator.nickName}}</a>\n                    </div>\n                </div>\n                <div class="Clear"></div>\n            </div>\n            <div class="icon-list">\n                <span class="view">0</span>\n                <span class="chat">{{item.bulletCurtain}}</span>\n                <span class="like">{{item.assemble}}</span>\n                <span class="hot">{{item.popularity}}</span>\n            </div>\n        </div>\n        {{/each}}\n        {{ if data.rooms.length <= 0}}\n        <div class="no-data">\n            暂无数据\n        </div>\n        {{/if}}\n\n    </script>\n    <!--分页-->\n    <div class="page-block">\n        <div class="page-wrap" id="page-wrap">\n\n        </div>\n    </div>\n</div>'},function(e,t,i){"use strict";var n=i(16),s=i(27),a=s.sharedInstanceUserModel(),o=i(109),r=i(110),l=i(51),c=n.extend({el:"#followingList",rawLoader:function(){return i(111)},events:{"click #followList":"cancelClicked"},beforeMount:function(){},afterMount:function(){this.followListModel=o.sigleInstance(),this.unFollowModel=r.sigleInstance(),this.followList=this.$el.find("#followList"),this.params={deviceinfo:'{"aid": "30001001"}',access_token:a.getWebToken(),size:9,offset:0},this.unFollowParams={deviceinfo:'{"aid": "30001001"}',access_token:a.getWebToken(),anchorId:0},this.followTpl=this.$el.find("#followTpl").text()},ready:function(){this.initPagination()},initPagination:function(){var e=this;this.pageing=$("#followPageWrap").paging(1,{format:"[ < .(qq -) nnncnn (- pp)> ] ",perpage:9,page:1,onFormat:function(e){switch(e){case"block":return this.active?this.value!=this.page?'<a href="#'+this.value+'">'+this.value+"</a>":'<span class="current ">'+this.value+"</span>":'<span class="disabled ">'+this.value+"</span>";case"next":return this.active?'<a href="#'+this.value+'" class="next ">&raquo;</a>':'<span class="disabled ">&raquo;</span>';case"prev":return this.active?'<a href="#'+this.value+'" class="prev ">&laquo;</a>':'<span class="disabled ">&laquo;</span>';case"fill":return this.active?"<span>...</span>":""}return""},onSelect:function(t){e.getPageList(t)}})},getPageList:function(e){var t=this;this.params.offset=9*(e-1),t.followListModel.executeJSONP(this.params,function(e){t.renderList(e),!t.totalCount&&e.data.totalCount&&(t.totalCount=e.data.totalCount,t.pageing.setNumber(t.totalCount),t.pageing.setPage())},function(){t.pageing.setNumber(1),t.pageing.setPage()})},renderList:function(e){var t=this.compileHTML(this.followTpl,e);this.followList.html(t)},formatData:function(e){return e&&_.each(e.data,function(e){var t=new Date(e.startTime);e.startTimeTxt=t.Format("yyyy/MM/dd");var i=DateTime.difference(e.duration);e.durationTxt=i.hours+":"+i.minutes+":"+i.seconds}),e},cancelClicked:function(e){var t=this;this.unFollowParams.anchorId=$(e.target).data("id"),this.unFollowParams.anchorId&&this.unFollowModel.executeJSONP(this.unFollowParams,function(e){0==e.code?(l.showOK("已取消关注"),t.getPageList()):l.showTip("取消关注失败,稍后重试")},function(){l.showTip("取消关注失败,稍后重试")})}});e.exports=c},function(e,t,i){"use strict";var n=i(24),s=null,a=n.extend({url:"{{url_prefix}}/user/anchor/follow_list.json?deviceinfo={{deviceinfo}}&access_token={{access_token}}&offset={{offset}}&size={{size}}",beforeEmit:function(e){}});a.sigleInstance=function(){return s||(s=new a),s},e.exports=a},function(e,t,i){"use strict";var n=i(24),s=null,a=n.extend({url:"{{url_prefix}}/user/anchor/unfollow.json?deviceinfo={{deviceinfo}}&anchorId={{anchorId}}",beforeEmit:function(e){}});a.sigleInstance=function(){return s||(s=new a),s},e.exports=a},function(e,t){e.exports='<div class="following-wrap">\n    <div id="followList">\n        加载中...\n    </div>\n    <!---->\n    <script type="text/x-template" id="followTpl">\n        {{each data.users as item}}\n        <div class="item">\n            <a class="avatar Left" href="###"><img src="{{item.largeAvatar}}" onerror="this.src=\'../img/bg-demo.jpg\'"\n                                                alt=""></a>\n            <div class="info-wrap Left">\n                <div class="name">{{item.nickName}}</div>\n                <div class="played">主持的主播:\n                    <sapn class="total">{{item.liveCount}}</sapn>\n                    场\n                </div>\n                <button data-id="{{item.uid}}" class="btn Hand">取消关注</button>\n            </div>\n            <div class="Clear"></div>\n        </div>\n        {{/each}}\n        {{ if data.users.length<= 0 }}\n        <div class="no-data">\n            暂无数据\n        </div>\n        {{/if}}\n    </script>\n    <!---->\n    <div class="page-block">\n        <div class="page-wrap" id="followPageWrap">\n\n        </div>\n    </div>\n\n</div>'},function(e,t){e.exports='<ul id="tab-menu-ctrl" class="subnav1 fl" style="height: inherit;">\n    <!--<li data-panel="tab-my-live" class="on">我的直播<span>&gt;</span></li>-->\n    <!--<li data-panel="createLiveVideo">创建直播<span>&gt;</span></li>-->\n    <!--<li data-panel="tabSetting">个人设置<span>&gt;</span></li>-->\n    <!--<li data-panel="signout">退出<span>&gt;</span></li>-->\n</ul>\n<script type="text/template" id="menuTpl">\n    {{each list as value}}\n    <li data-panel="{{value.pannel}}" class="{{value.active?\'on\': \'\'}}">{{value.name}}<span>&gt;</span></li>\n    {{/each}}\n</script>\n<div class="anPc-list fl tab-panel-wraper">\n    <!--主播-->\n    <div id="tab-my-live" class="tab-panel myLiveBox">\n        <ol class="myLiveControls clearfix" id="liveState">\n            <li class="fl on" data-state="0">未开播</li>\n            <li class="fl" data-state="1">历史直播</li>\n        </ol>\n        <div class="Mylive">\n            <div class="preLive show" id="noOpenListLive">\n                <ul id="noOpenContent"></ul>\n                <div class="page">\n                    <div class="PageBox" id="noOpenPageBox"></div>\n                </div>\n            </div>\n            <div class="liveHistory" id="historyListLive">\n                <ul id="historyContent"></ul>\n                <div class="page">\n                    <div class="PageBox" id="historyPageBox"></div>\n                </div>\n            </div>\n        </div>\n    </div>\n    <div class="tab-panel creatLive" id="createLiveVideo">\n    </div>\n    <!--个人-->\n    <div class="tab-panel Hidden" id="recordList">\n        <!--观看记录-->\n    </div>\n\n    <div class="tab-panel " id="followingList" >\n        <!--我的关注-->\n    </div>\n\n    <!--通用-->\n    <div class="tab-panel setting" id="tabSetting">\n        <ol class="setContrl clearfix" id="profileSate">\n            <li class="fl on" data-state="0">个人资料</li>\n            <li class="fl" data-state="1">修改密码</li>\n        </ol>\n        <div class="set_Con">\n            <div class="personInfo show" id="editProfile">\n\n            </div>\n            <div class="modifyPwd" id="updatePassword">\n\n            </div>\n\n        </div>\n    </div>\n    <!-- <div class="signOut"></div> -->\n</div>\n'},function(e,t){e.exports='<!--编辑背景图片-->\n<div class="title">\n	<span class="editorBg_btn" id="editBgBtn">编辑背景</span>\n</div>\n<div class="contentBox">\n	<!--profile-->\n	<div class="anchorMsg_con clearfix" id="settingProfile"></div>\n	<!-- 页面主体部分 -->\n	<div class="content clearfix" id="pageContent"></div>\n</div>\n'},function(e,t){}]);